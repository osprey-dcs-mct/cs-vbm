record(motor, "$(P)$(Q)linr_motor") {
  field(DESC, "Y motor")
  field(DTYP, "Soft Channel")
  field(RINP, "$(P)$(Q)linr_motor_scale_")
  field(OUT,  "$(P)$(Q)linr PP")
  field(DINP, "$(P)$(Q)linr_done_calc_")
  field(PREC, 5)
  field(MRES, "$(MRES=0.00001)")
  field(RTRY, "0")
  field(STOO, "$(P)$(Q)stop.PROC")

  info(autosaveFields, "TWV")
}

record(calc, "$(P)$(Q)linr_done_calc_") {
  field(DESC, "Calculate motor done status")
  field(INPA, "$(P)$(M1).DMOV CPP")
  field(INPB, "$(P)$(M2).DMOV CPP")
  field(INPC, "$(P)$(M3).DMOV CPP")
  field(CALC, "A==1&&B==1&&C==1")
}

record(calc, "$(P)$(Q)linr_motor_scale_") {
  field(DESC, "Motor scaling calculation -> RVAL")
  field(PINI, "YES")
  field(INPA, "$(P)$(Q)t2.D CPP")
  field(INPB, "$(CS_MRES=0.00001)")
  field(CALC, "A/B")
}

record(motor, "$(P)$(Q)pitch_motor") {
  field(DESC, "Pitch motor")
  field(DTYP, "Soft Channel")
  field(RINP, "$(P)$(Q)pitch_motor_scale_")
  field(OUT,  "$(P)$(Q)pitch PP")
  field(DINP, "$(P)$(Q)pitch_done_calc_")
  field(PREC, "5")
  field(MRES, "$(MRES=0.00001)")
  field(RTRY, "0")
  field(STOO, "$(P)$(Q)stop.PROC")

  info(autosaveFields, "TWV")
}

record(calc, "$(P)$(Q)pitch_done_calc_") {
  field(DESC, "Calculate motor done status")
  field(INPA, "$(P)$(M1).DMOV CPP")
  field(INPB, "$(P)$(M2).DMOV CPP")
  field(INPC, "$(P)$(M3).DMOV CPP")
  field(CALC, "A==1&&B==1&&C==1")
}

record(calc, "$(P)$(Q)pitch_motor_scale_") {
  field(DESC, "Motor scaling calculation -> RVAL")
  field(PINI, "YES")
  field(INPA, "$(P)$(Q)t2.E CPP")
  field(INPB, "$(CS_MRES=0.00001)")
  field(CALC, "A/B")
}

record(motor, "$(P)$(Q)roll_motor") {
  field(DESC, "Roll motor")
  field(DTYP, "Soft Channel")
  field(RINP, "$(P)$(Q)roll_motor_scale_")
  field(OUT,  "$(P)$(Q)roll PP")
  field(DINP, "$(P)$(Q)roll_done_calc_")
  field(PREC, "5")
  field(MRES, "$(MRES=0.00001)")
  field(RTRY, "0")
  field(STOO, "$(P)$(Q)stop.PROC")

  info(autosaveFields, "TWV")
}

record(calc, "$(P)$(Q)roll_done_calc_") {
  field(DESC, "Calculate motor done status")
  field(INPA, "$(P)$(M1).DMOV CPP")
  field(INPB, "$(P)$(M2).DMOV CPP")
  field(INPC, "$(P)$(M3).DMOV CPP")
  field(CALC, "A==1&&B==1&&C==1")
}

record(calc, "$(P)$(Q)roll_motor_scale_") {
  field(DESC, "Motor scaling calculation -> RVAL")
  field(PINI, "YES")
  field(INPA, "$(P)$(Q)t2.F CPP")
  field(INPB, "$(CS_MRES=0.00001)")
  field(CALC, "A/B")
}

record(dfanout, "$(P)$(Q)stop"){
  field(OMSL, "supervisory")
  field(VAL, "1")
  field(OUTA, "$(P)$(M1).STOP PP")
  field(OUTB, "$(P)$(M2).STOP PP")
  field(OUTC, "$(P)$(M3).STOP PP")
  field(FLNK, "$(P)$(Q)sync_stop.PROC")
}

record(seq, "$(P)$(Q)sync_stop")
{
  field(DLY1, "0.5")
  field(DOL1, "1")
  field(LNK1, "$(P)$(Q)sync.PROC")
}

record(calc, "$(P)$(Q)speed_alarm")
{
  field(INPA, "$(P)$(M1).VELO CP")
  field(INPB, "$(P)$(M2).VELO CP")
  field(INPC, "$(P)$(M3).VELO CP")
  field(INPD, "$(P)$(Q)speed MS")
  field(PINI, "YES")
  field(CALC, "ABS(A-B)+ABS(A-C)<0.0001?0:1")
  field(HIHI, "0.1")
  field(HHSV, "MAJOR")
}

record(dfanout, "$(P)$(Q)speed"){
  field(OMSL, "supervisory")
  field(EGU, "mm/sec")
  field(OUTA, "$(P)$(M1).VELO")
  field(OUTB, "$(P)$(M2).VELO")
  field(OUTC, "$(P)$(M3).VELO")
}